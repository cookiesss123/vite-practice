import{M as w}from"./modal-f00b1663.js";import{_ as f,m as p,o as r,c as a,b as t,t as e,n as y,F as h,h as _,g as O,j as g,r as $,d as k}from"./index-878bfeda.js";const{VITE_URL:M,VITE_PATH:E}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"cookiesss",BASE_URL:"/vite-practice/",MODE:"production",DEV:!1,PROD:!0},V={props:["id","orders","getOrders","openModal"],data(){return{myModal:{},tempOrder:{user:{}}}},methods:{show(){this.myModal.show()},hide(){this.myModal.hide()},updateOrder(n){this.$http.put(`${M}/api/${E}/admin/order/${n.id}`,{data:n}).then(l=>{console.log(l.data.message),this.getOrders(),this.hide(),this.$swal({icon:"success",title:l.data.message,showConfirmButton:!1,timer:1e3})}).catch(l=>{console.log(l.response.data.message)})}},mounted(){this.myModal=new w(this.$refs.orderModal)},watch:{id(){this.id&&(this.tempOrder=this.orders.filter(n=>n.id===this.id),this.tempOrder=this.tempOrder[0],this.openModal(""),this.show(),console.log(this.tempOrder))}}},x={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},T={class:"modal-dialog modal-xl"},D={class:"modal-content"},C=t("div",{class:"modal-header bg-dark"},[t("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訂單細節"),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body row"},L={class:"col-4"},U=t("h2",null,"用戶資料",-1),R={class:"table"},A=t("td",{class:"fw-bold"},"姓名",-1),B=t("td",{class:"fw-bold"},"Email",-1),P=t("td",{class:"fw-bold"},"電話",-1),H=t("td",{class:"fw-bold"},"地址",-1),S={class:"col-8"},F=t("h2",null,"訂單細節",-1),q={class:"table"},z=t("td",{class:"fw-bold"},"訂單編號",-1),N=t("td",{class:"fw-bold"},"下單時間",-1),j=t("td",{class:"fw-bold"},"付款時間",-1),Y=t("td",{class:"fw-bold"},"付款狀態",-1),G=t("td",{class:"fw-bold"},"總金額",-1),J=t("h2",null,"選購商品",-1),K={class:"table"},Q={class:"text-end"},W={class:"d-flex"},X={class:"form-check ms-auto"},Z={class:"form-check-label",for:"pay"},tt={class:"modal-footer"},et=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function st(n,l,i,v,s,c){const u=p("true"),d=p("false");return r(),a("div",x,[t("div",T,[t("div",D,[C,t("div",I,[t("div",L,[U,t("table",R,[t("tbody",null,[t("tr",null,[A,t("td",null,e(s.tempOrder.user.name),1)]),t("tr",null,[B,t("td",null,e(s.tempOrder.user.email),1)]),t("tr",null,[P,t("td",null,e(s.tempOrder.user.tel),1)]),t("tr",null,[H,t("td",null,e(s.tempOrder.user.address),1)])])])]),t("div",S,[F,t("table",q,[t("tbody",null,[t("tr",null,[z,t("td",null,e(s.tempOrder.id),1)]),t("tr",null,[N,t("td",null,e(new Date(s.tempOrder.create_at*1e3).toLocaleString().split(" ")[0]),1)]),t("tr",null,[j,t("td",null,e(new Date(s.tempOrder.paid_date*1e3).toLocaleString().split(" ")[0]),1)]),t("tr",null,[Y,t("td",{class:y({"text-success":s.tempOrder.is_paid})},e(`${s.tempOrder.is_paid?"已付款":"未付款"}`),3)]),t("tr",null,[G,t("td",null,e(s.tempOrder.total),1)])])]),J,t("table",K,[t("tbody",null,[(r(!0),a(h,null,_(s.tempOrder.products,o=>(r(),a("tr",{key:o.id},[t("td",null,e(o.product.title),1),t("td",null,e(o.qty)+" / "+e(o.product.unit),1),t("td",Q,e(o.final_total),1)]))),128))])]),t("div",W,[t("div",X,[O(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"pay","onUpdate:modelValue":l[0]||(l[0]=o=>s.tempOrder.is_paid=o)},null,512),[[u,1],[d,0],[g,s.tempOrder.is_paid]]),t("label",Z,e(`${s.tempOrder.is_paid?"已付款":"未付款"}`),1)])])])]),t("div",tt,[et,t("button",{type:"button",class:"btn btn-primary",onClick:l[1]||(l[1]=o=>c.updateOrder(this.tempOrder))},"修改付款狀態")])])])],512)}const ot=f(V,[["render",st]]),{VITE_URL:m,VITE_PATH:b}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"cookiesss",BASE_URL:"/vite-practice/",MODE:"production",DEV:!1,PROD:!0},lt={components:{OrderModal:ot},data(){return{orders:[],orderId:""}},methods:{getOrders(){const n=this.$loading.show(),l=document.cookie.replace(/(?:(?:^|.*;\s*)cookiesssToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=l,this.$http.get(`${m}/api/${b}/admin/orders`).then(i=>{console.log(i.data.orders),this.orders=i.data.orders,n.hide()}).catch(i=>{console.log(i.response.data.message)})},openModal(n){this.orderId=n},deleteOrder(n){this.$http.delete(`${m}/api/${b}/admin/order/${n}`).then(l=>{console.log(l.data.message),this.$swal({icon:"success",title:l.data.message,showConfirmButton:!1,timer:1e3}),this.getOrders()}).catch(l=>{console.log(l.response.data.message)})}},mounted(){this.getOrders()}},dt=t("h1",null,"訂單列表",-1),nt={class:"table"},rt=t("thead",null,[t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1),at={class:"form-check form-switch"},it=["onUpdate:modelValue","onChange"],ct={class:"form-check-label",for:"pay"},ut={class:"btn-group"},ht=["onClick"],_t=["onClick"];function pt(n,l,i,v,s,c){const u=$("OrderModal");return r(),a("div",null,[dt,t("table",nt,[rt,t("tbody",null,[(r(!0),a(h,null,_(s.orders,d=>(r(),a("tr",{key:d.id},[t("td",null,e(`${new Date(d.create_at*1e3).getFullYear()}/${new Date(d.create_at*1e3).getMonth()+1}/${new Date(d.create_at*1e3).getDate()}`),1),t("td",null,e(d.user.email),1),t("td",null,[(r(!0),a(h,null,_(d.products,o=>(r(),a("p",{key:o.id,class:"mb-0"},e(o.product.title)+" 數量："+e(o.qty)+" "+e(o.product.unit),1))),128))]),t("td",null,e(d.total),1),t("td",null,[t("div",at,[O(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"pay","onUpdate:modelValue":o=>d.is_paid=o,onChange:o=>this.$refs.modal.updateOrder(d)},null,40,it),[[g,d.is_paid]]),t("label",ct,e(`${d.is_paid?"已付款":"未付款"}`),1)])]),t("td",null,[t("div",ut,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:o=>c.openModal(d.id)},"檢視",8,ht),t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:o=>c.deleteOrder(d.id)},"刪除",8,_t)])])]))),128))])]),k(u,{ref:"modal",id:s.orderId,orders:s.orders,"get-orders":c.getOrders,"open-modal":c.openModal},null,8,["id","orders","get-orders","open-modal"])])}const ft=f(lt,[["render",pt]]);export{ft as default};
