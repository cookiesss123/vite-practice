import{_ as $,a as v,r as k,o as l,c as a,b as t,F as p,h as g,t as n,i as m,g as f,v as w,p as V,d as y,w as x,f as b,q as B}from"./index-01685dd6.js";const{VITE_URL:r,VITE_PATH:u}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"cookiesss",BASE_URL:"/vite-practice/",MODE:"production",DEV:!1,PROD:!0},E={components:{RouterLink:v},data(){return{cart:{},products:[],code:""}},methods:{getCarts(){this.$http.get(`${r}/api/${u}/cart`).then(e=>{console.log(e.data.data),this.cart=e.data.data}).catch(e=>{console.log(e.response.data.message)})},getProducts(){this.$http.get(`${r}/api/${u}/products/all`).then(e=>{console.log(e.data.products),this.products=e.data.products}).catch(e=>{console.log(e.response.data.message)})},addCart(e,o=1){const h={product_id:e,qty:o};this.$http.post(`${r}/api/${u}/cart`,{data:h}).then(_=>{this.$swal({icon:"success",title:_.data.message,showConfirmButton:!1,timer:1e3}),this.getCarts()}).catch(_=>{console.log(_.response.data.message)})},deleteCart(e){this.$http.delete(`${r}/api/${u}/cart/${e}`).then(o=>{this.$swal({icon:"success",title:o.data.message,showConfirmButton:!1,timer:1e3}),this.getCarts()}).catch(o=>{console.log(o.response.data.message)})},deleteAll(){this.$http.delete(`${r}/api/${u}/carts`).then(e=>{this.$swal({icon:"success",title:e.data.message,showConfirmButton:!1,timer:1e3}),this.getCarts()}).catch(e=>{console.log(e.response.data.message)})},useCoupon(){const e={code:this.code};this.$http.post(`${r}/api/${u}/coupon`,{data:e}).then(o=>{console.log(o.data),this.getCarts(),this.$swal({icon:"success",title:o.data.message,showConfirmButton:!1,timer:1e3})}).catch(o=>{console.log(o.response.data.message),this.$swal({icon:"error",title:o.response.data.message,showConfirmButton:!1,timer:1e3})})},updateCartItem(e){const o={product_id:e.product.id,qty:e.qty};this.$http.put(`${r}/api/${u}/cart/${e.id}`,{data:o}).then(h=>{this.$swal({icon:"success",title:h.data.message,showConfirmButton:!1,timer:1e3}),this.getCarts()}).catch(h=>{console.log(h.response.data.message)})}},mounted(){this.getCarts(),this.getProducts()}},T={class:"container"},L=t("h1",null,"購物車",-1),R={class:"table",style:{"vertical-align":"middle"}},U=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th",null,"功能")])],-1),A={style:{width:"200px"}},I={class:"btn-group"},q=["onClick"],D={class:"d-flex"},P={class:"table",style:{"vertical-align":"middle"}},N=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",null,"數量"),t("th",null,"單價")])],-1),S=["onClick"],M=t("i",{class:"bi bi-x"},null,-1),z=[M],F={class:"mb-0"},H={key:0,class:"mb-0 text-success"},O={style:{width:"150px"}},j={class:"input-group mb-3"},G=["onUpdate:modelValue","onChange"],J=["value"],K={class:"input-group-text",id:"basic-addon2"},Q={class:"text-end"},W={key:0},X=t("span",{class:"text-success"},"折扣價：",-1),Y=t("td",null,null,-1),Z=t("td",null,null,-1),tt=t("td",{class:"text-end"},"總計",-1),st={class:"text-end"},et={key:0},ot=t("td",null,null,-1),nt=t("td",null,null,-1),lt=t("td",{class:"text-end"},"折扣價：",-1),at={class:"text-end text-success"},ct={class:"input-group mb-3"};function dt(e,o,h,_,c,i){const C=k("RouterLink");return l(),a("div",T,[L,t("table",R,[U,t("tbody",null,[(l(!0),a(p,null,g(c.products,s=>(l(),a("tr",{key:s.id},[t("td",A,[t("div",{style:V([{"background-image":`url(${s.imageUrl})`},{height:"100px","background-position":"center","background-size":"cover"}])},null,4)]),t("td",null,[y(C,{to:"/login"},{default:x(()=>[b(n(s.title),1)]),_:2},1024)]),t("td",null,[t("del",null," 原價 "+n(s.origin_price)+" 元 ",1),t("h5",null,"現在只要 "+n(s.price)+" 元",1)]),t("td",null,[t("div",I,[y(C,{to:`/product/${s.id}`,class:"btn btn-sm btn-outline-secondary"},{default:x(()=>[b("查看更多")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:d=>i.addCart(s.id)},"加到購物車",8,q)])])]))),128))])]),t("div",D,[t("button",{type:"button",class:"btn btn-outline-danger ms-auto",onClick:o[0]||(o[0]=(...s)=>i.deleteAll&&i.deleteAll(...s))},"清空購物車")]),t("table",P,[N,t("tbody",null,[(l(!0),a(p,null,g(c.cart.carts,s=>(l(),a("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger ms-auto py-1 px-2",onClick:d=>i.deleteCart(s.id)},z,8,S)]),t("td",null,[t("p",F,n(s.product.title),1),s.coupon?(l(),a("p",H,"已套用優惠券【"+n(s.coupon.title)+"】",1)):m("",!0)]),t("td",O,[t("div",j,[f(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":d=>s.qty=d,onChange:d=>i.updateCartItem(s)},[(l(),a(p,null,g(20,d=>t("option",{key:d+3453534,value:d},n(d),9,J)),64))],40,G),[[B,s.qty]]),t("span",K,"/"+n(s.product.unit),1)])]),t("td",Q,[t("p",null,"原價："+n(s.total),1),s.coupon?(l(),a("p",W,[X,b(n(s.final_total),1)])):m("",!0)])]))),128)),t("tr",null,[Y,Z,tt,t("td",st,n(c.cart.total),1)]),c.cart.final_total!==c.cart.total?(l(),a("tr",et,[ot,nt,lt,t("td",at,n(c.cart.final_total),1)])):m("",!0)])]),t("div",ct,[f(t("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":o[1]||(o[1]=s=>c.code=s)},null,512),[[w,c.code]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[2]||(o[2]=(...s)=>i.useCoupon&&i.useCoupon(...s))},"套用優惠碼")])])}const rt=$(E,[["render",dt]]);export{rt as default};
